<a href="https://github.com/SemanticComputing/angular-semantic-faceted-search/edit/master/src/facets/facets.module.js" class="improve-docs"><i class="icon-edit"> </i>Improve this doc</a><a href="https://github.com/SemanticComputing/angular-semantic-faceted-search/blob/ea3d729/src/facets/facets.module.js#L164" class="view-source"><i class="icon-eye-open"> </i>View source</a><h1><code ng:non-bindable=""></code>
<div><span class="hint"></span>
</div>
</h1>
<div><div class="index-page"><h2 id="sparql-faceter----faceted-search-based-on-sparql">SPARQL Faceter -- Faceted Search Based on SPARQL</h2>
<p>The module provides a set of directives that work as facets,
and a service that synchronizes them.</p>
<p>There are four different built-in facet types:</p>
<ul>
<li><a href="#/api/seco.facetedSearch.BasicFacet">seco.facetedSearch.BasicFacet</a> - A basic select box facet with text filtering</li>
<li><a href="#/api/seco.facetedSearch.HierarchyFacet">seco.facetedSearch.HierarchyFacet</a> - A basic facet with hierarchy support.</li>
<li><a href="#/api/seco.facetedSearch.TextFacet">seco.facetedSearch.TextFacet</a> - A free-text facet.</li>
<li><a href="#/api/seco.facetedSearch.TimespanFacet">seco.facetedSearch.TimespanFacet</a> - Date range facet.</li>
</ul>
<p>Custom facets can be implemented reasonably easily.</p>
<h3 id="sparql-faceter----faceted-search-based-on-sparql_how-it-works">How it works</h3>
<p>Facets are implemented as a directives.
Each facet listens on its scope for changes in other facets,
and emits its state when its value changes.
The facets are responsible for maintaining their own state.</p>
<p><a href="#/api/seco.facetedSearch.FacetHandler">seco.facetedSearch.FacetHandler</a> mediates the facet changes
by listening to the facets&#39; change events, and broadcasting the resulting
constraints to all facets in the scope.</p>
<p>The facets are configured using the <code>options</code> attribute of the directive.
Configuration options that are common to all facets are:</p>
<ul>
<li><strong>facetId</strong> - <code>{string}</code> - A friendly id for the facet. Should be unique in the set of facets, and should be usable as a SPARQL variable.</li>
<li><strong>predicate</strong> - <code>{string}</code> - The predicate or property path that defines the facet values.</li>
<li><strong>name</strong> - <code>{string}</code> - The title of the facet. Will be displayed to end users.</li>
<li><strong>enabled</strong> <code>{boolean}</code> - Whether or not the facet is enabled by default.</li>
</ul>
<p>For other options, see the facets&#39; individual documentation.</p>
</div><h2 id="example">Example</h2>
<div class="example"><div class="index-page"><pre class="prettyprint linenums">
// Define facets
vm.facets = {
    // Text facet
    name: {
        name: 'Name',
        facetId: 'name',
        predicate: '&lt;http://www.w3.org/2004/02/skos/core#prefLabel&gt;',
        enabled: true
    },
    // Date facet
    deathDate: {
        name: 'Time of Death',
        facetId: 'death',
        startPredicate: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/kuolinaika&gt;',
        endPredicate: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/kuolinaika&gt;',
        min: '1939-10-01',
        max: '1989-12-31',
        enabled: true
    },
    // Basic facet
    profession: {
        name: 'Ammatti',
        facetId: 'occupation',
        predicate: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/ammatti&gt;',
        enabled: true
    },
    // Basic facet with property path
    source: {
        name: 'Source',
        facetId: 'source',
        predicate: '^&lt;http://www.cidoc-crm.org/cidoc-crm/P70i_is_documented_in&gt;/&lt;http://purl.org/dc/elements/1.1/source&gt;',
        enabled: true
    },
    // Basic facet with labels in another service.
    birthMunicipality: {
        name: 'Birth Municipality',
        services: ['&lt;http://ldf.fi/pnr/sparql&gt;'],
        facetId: 'birthplace',
        predicate: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/synnyinkunta&gt;',
        enabled: false
    },
    // Hierarchical facet
    rank: {
        name: 'Rank',
        facetId: 'rank',
        predicate: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/sotilasarvo&gt;',
        hierarchy: '&lt;http://purl.org/dc/terms/isPartOf&gt;*|(&lt;http://rdf.muninn-project.org/ontologies/organization#equalTo&gt;/&lt;http://purl.org/dc/terms/isPartOf&gt;*)',
        enabled: true,
        classes: [
            '&lt;http://ldf.fi/warsa/actors/ranks/Upseeri&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Aliupseeri&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Miehistoe&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Jaeaekaeriarvo&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Virkahenkiloestoe&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Lottahenkiloestoe&gt;',
            '&lt;http://ldf.fi/warsa/actors/ranks/Muu&gt;'
        ]
    }
};

// Define common options
vm.options = {
    scope: $scope,
    endpointUrl: 'http://ldf.fi/warsa/sparql',
    rdfClass: '&lt;http://ldf.fi/schema/narc-menehtyneet1939-45/DeathRecord&gt;',
    constraint: '?id skos:prefLabel ?name .',
    preferredLang : 'fi'
};

// Define a function that handles updates.
// 'dataService' is some service that fetches results based on the facet selections.
function updateResults(event, facetState) {
    dataService.getResults(facetState.constraints).then(function(results) {
        vm.results = results;
    }
}

// Listen for the update event
$scope.$on('sf-facet-constraints', updateResults);

// Listen for initial state
var initListener = $scope.$on('sf-initial-constraints', function(event, state) {
    updateResults(event, state);
    // Only listen once for the init event
    initListener();
});

// Initialize the facet handler:
vm.handler = new FacetHandler(vm.options);
</pre>
<p>Setup the facets in the template:</p>
<pre class="prettyprint linenums">
&lt;seco-text-facet
  data-options="vm.facets.name"&gt;
&lt;/seco-text-facet&gt;
&lt;seco-timespan-facet
  data-options="vm.facets.deathDate"&gt;
&lt;/seco-timespan-facet&gt;
&lt;seco-basic-facet
  data-options="vm.facets.source"&gt;
&lt;/seco-basic-facet&gt;
&lt;seco-basic-facet
  data-options="vm.facets.profession"&gt;
&lt;/seco-basic-facet&gt;
&lt;seco-basic-facet
  data-options="vm.facets.birthMunicipality"&gt;
&lt;/seco-basic-facet&gt;
&lt;seco-basic-facet
  data-options="vm.facets.principalAbode"&gt;
&lt;/seco-basic-facet&gt;
&lt;seco-hierarchy-facet
  data-options="vm.facets.rank"&gt;
&lt;/seco-hierarchy-facet&gt;
</pre>
</div></div>
</div>
